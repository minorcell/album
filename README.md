# Studio Album

åŸºäº Next.js 15 + Prisma + MySQL æ„å»ºçš„å·¥ä½œå®¤å†…éƒ¨åœ¨çº¿ç›¸å†Œä¸è¯ä¹¦ç®¡ç†ç³»ç»Ÿï¼Œæ”¯æŒæˆå‘˜ä¸Šä¼ ã€åˆ†ç±»æµè§ˆã€æƒé™æ§åˆ¶ä»¥åŠåˆ†äº«é“¾æ¥è®¿é—®ã€‚

## åŠŸèƒ½æ¦‚è§ˆ

- ğŸ“ **åˆ†ç±»ç®¡ç†**ï¼šç®¡ç†å‘˜å¯å¢åˆ æ”¹æŸ¥åˆ†ç±»ï¼Œæ”¯æŒä¸‰ç§å¯è§æ€§çº§åˆ«ï¼ˆç§æœ‰ã€å†…éƒ¨ã€å…¬å¼€ï¼‰ï¼Œé¦–é¡µå±•ç¤ºåˆ†ç±»ç»Ÿè®¡
- ğŸ“· **å›¾ç‰‡ä¸Šä¼ **ï¼šæˆå‘˜å¯æ‰¹é‡ä¸Šä¼  JPG/PNGï¼Œè‡ªåŠ¨ç”Ÿæˆç¼©ç•¥å›¾å¹¶å­˜å‚¨è‡³ `public/uploads`ï¼Œæ”¯æŒåŸå§‹æ–‡ä»¶åä¿ç•™
- ğŸ§‘â€ğŸ¤â€ğŸ§‘ **ç”¨æˆ·ä½“ç³»**ï¼šæ”¯æŒæ³¨å†Œ/ç™»å½•ï¼Œé¦–ä¸ªæ³¨å†Œç”¨æˆ·è‡ªåŠ¨æˆä¸ºç®¡ç†å‘˜ï¼Œå¯åˆ†é…æˆå‘˜è§’è‰²
- ğŸ” **æƒé™æ§åˆ¶**ï¼š
  - å†™æ“ä½œï¼ˆä¸Šä¼ ã€åˆ é™¤ã€ç¼–è¾‘ï¼‰éœ€ç™»å½•
  - ç®¡ç†å‘˜æ‹¥æœ‰åˆ†ç±»ã€ç”¨æˆ·ã€åˆ†äº«é“¾æ¥çš„å®Œæ•´ç®¡ç†æƒé™
  - æˆå‘˜åªèƒ½åˆ é™¤/ç¼–è¾‘è‡ªå·±ä¸Šä¼ çš„ç…§ç‰‡
  - æ”¯æŒåˆ†ç±»çº§åˆ«çš„å¯è§æ€§æ§åˆ¶ï¼ˆprivate/internal/publicï¼‰
- ğŸ”— **åˆ†äº«è®¿é—®**ï¼šç®¡ç†å‘˜å¯ä¸ºåˆ†ç±»ç”Ÿæˆå¸¦å¯†ç ä¸è¿‡æœŸæ—¶é—´çš„åˆ†äº«é“¾æ¥ï¼Œè®¿å®¢å¯é€šè¿‡é“¾æ¥æµè§ˆå†…å®¹
- ğŸ“¦ **æ‰¹é‡ä¸‹è½½**ï¼šæ”¯æŒæ‰¹é‡é€‰æ‹©å›¾ç‰‡æ‰“åŒ…ä¸‹è½½ä¸º ZIP æ–‡ä»¶
- ğŸ›ï¸ **ç®¡ç†åå°**ï¼šç»Ÿä¸€å…¥å£ç®¡ç†åˆ†ç±»ã€æˆå‘˜è§’è‰²ã€åˆ†äº«é“¾æ¥ï¼Œæ”¯æŒåˆ†ç±»å¯è§æ€§è®¾ç½®
- ğŸ–¼ï¸ **å“åº”å¼è®¾è®¡**ï¼šå®Œç¾é€‚é…æ¡Œé¢ç«¯å’Œç§»åŠ¨ç«¯

## æŠ€æœ¯æ ˆ

- **æ¡†æ¶**ï¼šNext.js 15ï¼ˆApp Routerï¼‰
- **æ•°æ®åº“**ï¼šPrisma ORM + MySQL 8.0+
- **è®¤è¯**ï¼šNextAuth.js v4ï¼ˆCredentials Providerï¼‰
- **æ ·å¼**ï¼šTailwind CSS 4 + shadcn/ui
- **å›¾ç‰‡å¤„ç†**ï¼šsharpï¼ˆè‡ªåŠ¨ç”Ÿæˆç¼©ç•¥å›¾ï¼‰
- **åŒ…ç®¡ç†**ï¼špnpm
- **ç±»å‹æ£€æŸ¥**ï¼šTypeScript 5
- **æ•°æ®éªŒè¯**ï¼šZod

## å¿«é€Ÿå¼€å§‹

### æ–¹å¼ä¸€ï¼šä¸€é”®å¯åŠ¨è„šæœ¬ï¼ˆæ¨èï¼‰

> è‡ªåŠ¨å®Œæˆä¾èµ–å®‰è£…ã€æ•°æ®åº“åˆå§‹åŒ–ä¸å¼€å‘æœåŠ¡å™¨å¯åŠ¨ï¼š

```bash
./scripts/dev-start.sh
```

### æ–¹å¼äºŒï¼šæ‰‹åŠ¨æ­¥éª¤

#### 1. ç¯å¢ƒè¦æ±‚

- Node.js >= 18.0
- pnpm >= 8.0
- MySQL >= 8.0

#### 2. å®‰è£…ä¾èµ–

```bash
pnpm install
```

#### 3. é…ç½®ç¯å¢ƒå˜é‡

å¤åˆ¶ `.env.example` ä¸º `.env` å¹¶ä¿®æ”¹é…ç½®ï¼š

```bash
cp .env.example .env
```

ç¼–è¾‘ `.env` æ–‡ä»¶ï¼š

```env
# æ•°æ®åº“è¿æ¥ä¸²ï¼ˆå¿…å¡«ï¼‰
DATABASE_URL="mysql://album_user:album_password@localhost:3306/cp_album"

# NextAuth JWT ç­¾åå¯†é’¥ï¼ˆå¿…å¡«ï¼Œç”Ÿäº§ç¯å¢ƒè¯·ä½¿ç”¨å¼ºéšæœºå­—ç¬¦ä¸²ï¼‰
# ç”Ÿæˆæ–¹å¼ï¼šopenssl rand -base64 32
NEXTAUTH_SECRET="your_random_secret_here"

# åº”ç”¨è®¿é—®åœ°å€ï¼ˆå¼€å‘ç¯å¢ƒé»˜è®¤å³å¯ï¼‰
NEXTAUTH_URL="http://localhost:3000"

# æ–‡ä»¶ä¸Šä¼ ç›®å½•ï¼ˆç›¸å¯¹äºé¡¹ç›®æ ¹ç›®å½•ï¼‰
UPLOAD_PATH="./public/uploads"
```

#### 4. å¯åŠ¨æ•°æ®åº“

**é€‰é¡¹ Aï¼šä½¿ç”¨æœ¬åœ° MySQL**

ç¡®ä¿ MySQL æœåŠ¡å·²å¯åŠ¨ï¼Œå¹¶åˆ›å»ºå¯¹åº”çš„æ•°æ®åº“å’Œç”¨æˆ·ï¼š

```sql
CREATE DATABASE cp_album CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;
CREATE USER 'album_user'@'localhost' IDENTIFIED BY 'album_password';
GRANT ALL PRIVILEGES ON cp_album.* TO 'album_user'@'localhost';
FLUSH PRIVILEGES;
```

**é€‰é¡¹ Bï¼šä½¿ç”¨ Docker**

```bash
docker compose up -d mysql
```

#### 5. åˆå§‹åŒ–æ•°æ®åº“

```bash
# ç”Ÿæˆ Prisma Client
pnpm prisma:generate

# æ¨é€æ•°æ®åº“ schemaï¼ˆåˆ›å»ºè¡¨ç»“æ„ï¼‰
pnpm prisma:push
```

#### 6. å¯åŠ¨å¼€å‘æœåŠ¡å™¨

```bash
pnpm dev
```

è®¿é—® <http://localhost:3000>

### é¦–æ¬¡ä½¿ç”¨

1. ç‚¹å‡»å³ä¸Šè§’ã€Œç™»å½•/æ³¨å†Œã€
2. é¦–æ¬¡æ³¨å†Œçš„è´¦å·å°†è‡ªåŠ¨è·å¾— **ç®¡ç†å‘˜** æƒé™
3. åç»­æ³¨å†Œçš„ç”¨æˆ·é»˜è®¤ä¸º **æˆå‘˜** è§’è‰²
4. ç®¡ç†å‘˜å¯åœ¨ã€Œç®¡ç†åå°ã€ä¿®æ”¹ç”¨æˆ·è§’è‰²

## Docker éƒ¨ç½²

### å¼€å‘ç¯å¢ƒ

é¡¹ç›®åŒ…å«ç”¨äºå¼€å‘ç¯å¢ƒçš„ `docker-compose.yml` ä¸ `Dockerfile`ï¼š

```bash
# å¯åŠ¨æ‰€æœ‰æœåŠ¡ï¼ˆMySQL + Next.js å¼€å‘æœåŠ¡å™¨ï¼‰
docker compose up -d

# æŸ¥çœ‹æ—¥å¿—
docker compose logs -f studio-album

# åœæ­¢æ‰€æœ‰æœåŠ¡
docker compose down
```

æœåŠ¡è¯´æ˜ï¼š
- `mysql`ï¼šMySQL 8.0 æ•°æ®åº“æœåŠ¡
- `studio-album`ï¼šNext.js å¼€å‘æœåŠ¡å™¨ï¼ˆ`pnpm dev`ï¼‰

### ç”Ÿäº§ç¯å¢ƒ

1. **æ„å»ºç”Ÿäº§ç‰ˆæœ¬**

```bash
pnpm build
```

2. **å¯åŠ¨ç”Ÿäº§æœåŠ¡å™¨**

```bash
pnpm start
```

æˆ–ä½¿ç”¨ PM2ï¼š

```bash
pm2 start npm --name "studio-album" -- start
```

## ä¸»è¦è„šæœ¬

| å‘½ä»¤                      | è¯´æ˜                                    |
| ------------------------- | --------------------------------------- |
| `pnpm dev`                | å¯åŠ¨å¼€å‘æœåŠ¡å™¨ï¼ˆé»˜è®¤ç«¯å£ 3000ï¼‰         |
| `pnpm build`              | æ„å»ºç”Ÿäº§ç‰ˆæœ¬                            |
| `pnpm start`              | ä»¥ç”Ÿäº§æ¨¡å¼å¯åŠ¨                          |
| `pnpm lint`               | è¿è¡Œ ESLint æ£€æŸ¥                        |
| `pnpm prisma:generate`    | ç”Ÿæˆ Prisma Clientï¼ˆschema æ›´æ–°åå¿…é¡»ï¼‰ |
| `pnpm prisma:push`        | æ¨é€ Prisma schema è‡³æ•°æ®åº“ï¼ˆåŒæ­¥è¡¨ç»“æ„ï¼‰|

## ç›®å½•ç»“æ„

```
cp-album/
â”œâ”€â”€ app/                          # Next.js App Router
â”‚   â”œâ”€â”€ (auth)/                   # è®¤è¯ç›¸å…³é¡µé¢
â”‚   â”‚   â”œâ”€â”€ login/                # ç™»å½•é¡µé¢
â”‚   â”‚   â””â”€â”€ profile/              # ä¸ªäººèµ„æ–™é¡µé¢
â”‚   â”œâ”€â”€ admin/                    # ç®¡ç†åå°
â”‚   â”œâ”€â”€ album/[id]/               # åˆ†ç±»ç›¸å†Œè¯¦æƒ…é¡µ
â”‚   â”œâ”€â”€ share/[token]/            # åˆ†äº«é“¾æ¥è®¿é—®é¡µ
â”‚   â”œâ”€â”€ upload/                   # å›¾ç‰‡ä¸Šä¼ é¡µé¢
â”‚   â”œâ”€â”€ api/                      # API Route Handlers
â”‚   â”‚   â”œâ”€â”€ auth/[...nextauth]/   # NextAuth è®¤è¯ç«¯ç‚¹
â”‚   â”‚   â”œâ”€â”€ categories/           # åˆ†ç±»ç®¡ç† API
â”‚   â”‚   â”œâ”€â”€ photos/               # å›¾ç‰‡ç®¡ç† API
â”‚   â”‚   â”œâ”€â”€ share/                # åˆ†äº«é“¾æ¥ API
â”‚   â”‚   â”œâ”€â”€ upload/               # æ–‡ä»¶ä¸Šä¼  API
â”‚   â”‚   â”œâ”€â”€ users/                # ç”¨æˆ·ç®¡ç† API
â”‚   â”‚   â””â”€â”€ profile/              # ä¸ªäººèµ„æ–™ API
â”‚   â”œâ”€â”€ layout.tsx                # å…¨å±€å¸ƒå±€
â”‚   â””â”€â”€ page.tsx                  # é¦–é¡µï¼ˆåˆ†ç±»åˆ—è¡¨ï¼‰
â”œâ”€â”€ components/                   # React ç»„ä»¶
â”‚   â”œâ”€â”€ ui/                       # shadcn/ui åŸºç¡€ç»„ä»¶
â”‚   â”œâ”€â”€ admin-dashboard.tsx       # ç®¡ç†é¢æ¿
â”‚   â”œâ”€â”€ navbar.tsx                # é¡¶éƒ¨å¯¼èˆªæ 
â”‚   â”œâ”€â”€ photo-grid.tsx            # å›¾ç‰‡ç½‘æ ¼å±•ç¤º
â”‚   â”œâ”€â”€ share-viewer.tsx          # åˆ†äº«é“¾æ¥æµè§ˆå™¨
â”‚   â”œâ”€â”€ upload-form.tsx           # ä¸Šä¼ è¡¨å•
â”‚   â””â”€â”€ ...                       # å…¶ä»–ä¸šåŠ¡ç»„ä»¶
â”œâ”€â”€ lib/                          # å·¥å…·åº“
â”‚   â”œâ”€â”€ db.ts                     # Prisma å®¢æˆ·ç«¯å®ä¾‹
â”‚   â”œâ”€â”€ auth.ts                   # NextAuth é…ç½®
â”‚   â”œâ”€â”€ auth-guards.ts            # æƒé™æ£€æŸ¥å·¥å…·
â”‚   â”œâ”€â”€ storage.ts                # æ–‡ä»¶å­˜å‚¨å·¥å…·
â”‚   â””â”€â”€ utils.ts                  # é€šç”¨å·¥å…·å‡½æ•°
â”œâ”€â”€ prisma/                       # Prisma ORM
â”‚   â””â”€â”€ schema.prisma             # æ•°æ®åº“ schema å®šä¹‰
â”œâ”€â”€ public/                       # é™æ€èµ„æº
â”‚   â””â”€â”€ uploads/                  # ä¸Šä¼ æ–‡ä»¶å­˜å‚¨ç›®å½•
â”‚       â””â”€â”€ thumbnails/           # ç¼©ç•¥å›¾ç›®å½•
â”œâ”€â”€ scripts/                      # è¾…åŠ©è„šæœ¬
â”‚   â””â”€â”€ dev-start.sh              # å¼€å‘ç¯å¢ƒå¿«é€Ÿå¯åŠ¨è„šæœ¬
â”œâ”€â”€ .env.example                  # ç¯å¢ƒå˜é‡ç¤ºä¾‹
â”œâ”€â”€ docker-compose.yml            # Docker Compose é…ç½®
â”œâ”€â”€ Dockerfile                    # Docker é•œåƒæ„å»ºæ–‡ä»¶
â”œâ”€â”€ next.config.ts                # Next.js é…ç½®
â”œâ”€â”€ tailwind.config.ts            # Tailwind CSS é…ç½®
â”œâ”€â”€ tsconfig.json                 # TypeScript é…ç½®
â””â”€â”€ package.json                  # é¡¹ç›®ä¾èµ–
```

## æ•°æ®åº“ Schema

### æ ¸å¿ƒæ¨¡å‹

**Userï¼ˆç”¨æˆ·ï¼‰**
- `id`: ä¸»é”®
- `username`: ç”¨æˆ·åï¼ˆå”¯ä¸€ï¼‰
- `password`: å¯†ç ï¼ˆbcrypt åŠ å¯†ï¼‰
- `role`: è§’è‰²ï¼ˆadmin/memberï¼‰
- `createdAt`: åˆ›å»ºæ—¶é—´

**Categoryï¼ˆåˆ†ç±»ï¼‰**
- `id`: ä¸»é”®
- `name`: åˆ†ç±»åç§°
- `description`: åˆ†ç±»æè¿°
- `visibility`: å¯è§æ€§ï¼ˆprivate/internal/publicï¼‰
- `createdAt`: åˆ›å»ºæ—¶é—´

**Photoï¼ˆå›¾ç‰‡ï¼‰**
- `id`: ä¸»é”®
- `filename`: å­˜å‚¨æ–‡ä»¶å
- `originalName`: åŸå§‹æ–‡ä»¶å
- `description`: å›¾ç‰‡æè¿°
- `categoryId`: æ‰€å±åˆ†ç±» ID
- `uploaderId`: ä¸Šä¼ è€… ID
- `createdAt`: ä¸Šä¼ æ—¶é—´

**ShareLinkï¼ˆåˆ†äº«é“¾æ¥ï¼‰**
- `id`: ä¸»é”®
- `categoryId`: åˆ†ç±» ID
- `token`: è®¿é—®ä»¤ç‰Œï¼ˆå”¯ä¸€ï¼‰
- `password`: è®¿é—®å¯†ç ï¼ˆå¯é€‰ï¼‰
- `expiresAt`: è¿‡æœŸæ—¶é—´ï¼ˆå¯é€‰ï¼‰
- `createdAt`: åˆ›å»ºæ—¶é—´

### å¯è§æ€§çº§åˆ«è¯´æ˜

| çº§åˆ« | è¯´æ˜ | è®¿é—®æƒé™ |
|------|------|----------|
| `private` | ç§æœ‰ | ä»…ç®¡ç†å‘˜å¯è§ |
| `internal` | å†…éƒ¨ | æ‰€æœ‰ç™»å½•ç”¨æˆ·å¯è§ |
| `public` | å…¬å¼€ | æ‰€æœ‰äººå¯è§ï¼ˆåŒ…æ‹¬æœªç™»å½•ï¼‰ |

## åŠŸèƒ½è¯¦è§£

### ç”¨æˆ·æƒé™ä½“ç³»

| æ“ä½œ | æ¸¸å®¢ | æˆå‘˜ | ç®¡ç†å‘˜ |
|------|------|------|--------|
| æµè§ˆå…¬å¼€åˆ†ç±» | âœ… | âœ… | âœ… |
| æµè§ˆå†…éƒ¨åˆ†ç±» | âŒ | âœ… | âœ… |
| æµè§ˆç§æœ‰åˆ†ç±» | âŒ | âŒ | âœ… |
| ä¸Šä¼ å›¾ç‰‡ | âŒ | âœ… | âœ… |
| åˆ é™¤è‡ªå·±çš„å›¾ç‰‡ | âŒ | âœ… | âœ… |
| åˆ é™¤ä»–äººçš„å›¾ç‰‡ | âŒ | âŒ | âœ… |
| åˆ›å»º/ç¼–è¾‘åˆ†ç±» | âŒ | âŒ | âœ… |
| ç®¡ç†ç”¨æˆ·è§’è‰² | âŒ | âŒ | âœ… |
| åˆ›å»ºåˆ†äº«é“¾æ¥ | âŒ | âŒ | âœ… |

### å›¾ç‰‡ä¸Šä¼ æµç¨‹

1. ç”¨æˆ·é€‰æ‹©åˆ†ç±»å¹¶ä¸Šä¼ å›¾ç‰‡ï¼ˆæ”¯æŒå¤šé€‰ï¼‰
2. åç«¯éªŒè¯æ–‡ä»¶ç±»å‹ï¼ˆä»…æ”¯æŒ JPG/PNGï¼‰
3. ç”Ÿæˆå”¯ä¸€æ–‡ä»¶åï¼ˆUUID + æ‰©å±•åï¼‰
4. ä½¿ç”¨ sharp ç”Ÿæˆç¼©ç•¥å›¾ï¼ˆ300x300ï¼Œä¿æŒå®½é«˜æ¯”ï¼‰
5. ä¿å­˜åŸå›¾è‡³ `public/uploads/`
6. ä¿å­˜ç¼©ç•¥å›¾è‡³ `public/uploads/thumbnails/`
7. è®°å½•æ•°æ®åº“ï¼ˆåŒ…å«åŸå§‹æ–‡ä»¶åã€ä¸Šä¼ è€…ç­‰ä¿¡æ¯ï¼‰

### åˆ†äº«é“¾æ¥æœºåˆ¶

1. ç®¡ç†å‘˜ä¸ºæŒ‡å®šåˆ†ç±»åˆ›å»ºåˆ†äº«é“¾æ¥
2. å¯é€‰é…ç½®ï¼š
   - è®¿é—®å¯†ç ï¼ˆä¸ºç©ºåˆ™æ— éœ€å¯†ç ï¼‰
   - è¿‡æœŸæ—¶é—´ï¼ˆä¸ºç©ºåˆ™æ°¸ä¹…æœ‰æ•ˆï¼‰
3. ç”Ÿæˆå”¯ä¸€è®¿é—® tokenï¼ˆUUIDï¼‰
4. åˆ†äº«é“¾æ¥æ ¼å¼ï¼š`/share/{token}`
5. è®¿é—®æ—¶éªŒè¯å¯†ç å’Œæœ‰æ•ˆæœŸ
6. éªŒè¯é€šè¿‡åå¯æµè§ˆè¯¥åˆ†ç±»ä¸‹çš„æ‰€æœ‰å›¾ç‰‡

### æ‰¹é‡ä¸‹è½½åŠŸèƒ½

1. ç”¨æˆ·å‹¾é€‰å¤šå¼ å›¾ç‰‡
2. ç‚¹å‡»ã€Œä¸‹è½½é€‰ä¸­ã€æŒ‰é’®
3. åç«¯ä½¿ç”¨ JSZip æ‰“åŒ…åŸå›¾
4. è¿”å› ZIP æ–‡ä»¶æµ
5. æµè§ˆå™¨è‡ªåŠ¨ä¸‹è½½ï¼ˆæ–‡ä»¶åï¼š`photos-{timestamp}.zip`ï¼‰

## å®‰å…¨è¯´æ˜

- å¯†ç ä½¿ç”¨ bcrypt åŠ å¯†å­˜å‚¨ï¼ˆsalt rounds: 10ï¼‰
- NextAuth ä¼šè¯ä½¿ç”¨ JWTï¼Œé€šè¿‡ `NEXTAUTH_SECRET` ç­¾å
- API è·¯ç”±é€šè¿‡ `requireAuth()` ä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯
- æ–‡ä»¶ä¸Šä¼ é™åˆ¶ç±»å‹å’Œå¤§å°ï¼ˆé€šè¿‡ MIME type æ£€æŸ¥ï¼‰
- åˆ†äº«é“¾æ¥æ”¯æŒå¯†ç ä¿æŠ¤å’Œè¿‡æœŸæ—¶é—´
- SQL æ³¨å…¥é˜²æŠ¤ï¼ˆPrisma ORM è‡ªåŠ¨å‚æ•°åŒ–æŸ¥è¯¢ï¼‰

## å¸¸è§é—®é¢˜

### 1. å¦‚ä½•ç”Ÿæˆå®‰å…¨çš„ `NEXTAUTH_SECRET`ï¼Ÿ

```bash
openssl rand -base64 32
```

### 2. å¦‚ä½•ä¿®æ”¹ä¸Šä¼ æ–‡ä»¶å¤§å°é™åˆ¶ï¼Ÿ

ç¼–è¾‘ `app/api/upload/route.ts`ï¼Œä¿®æ”¹ `maxFileSizeMB` å¸¸é‡ã€‚

### 3. å¦‚ä½•è¿ç§»åˆ°å¯¹è±¡å­˜å‚¨ï¼ˆå¦‚ S3/OSSï¼‰ï¼Ÿ

æ›¿æ¢ `lib/storage.ts` ä¸­çš„æ–‡ä»¶å­˜å‚¨é€»è¾‘ï¼Œæ”¹ä¸ºè°ƒç”¨å¯¹è±¡å­˜å‚¨ SDKã€‚

### 4. æ•°æ®åº“è¿ç§»å¦‚ä½•å¤„ç†ï¼Ÿ

ç”Ÿäº§ç¯å¢ƒå»ºè®®ä½¿ç”¨ Prisma Migrateï¼š

```bash
# åˆ›å»ºè¿ç§»
npx prisma migrate dev --name init

# åº”ç”¨è¿ç§»
npx prisma migrate deploy
```

### 5. å¦‚ä½•å¤‡ä»½æ•°æ®ï¼Ÿ

```bash
# å¤‡ä»½æ•°æ®åº“
mysqldump -u album_user -p cp_album > backup.sql

# å¤‡ä»½ä¸Šä¼ æ–‡ä»¶
tar -czf uploads-backup.tar.gz public/uploads/
```

### 6. sharp å®‰è£…å¤±è´¥æ€ä¹ˆåŠï¼Ÿ

å¦‚æœé‡åˆ° `sharp` åŸç”Ÿæ¨¡å—ç¼–è¯‘é—®é¢˜ï¼š

```bash
# æ‰¹å‡†ä¾èµ–æ‰§è¡ŒåŸç”Ÿæ„å»º
pnpm approve-builds

# é‡æ–°å®‰è£…
pnpm install --force
```

## éƒ¨ç½²å»ºè®®

### ç”Ÿäº§ç¯å¢ƒæ£€æŸ¥æ¸…å•

- [ ] ä¿®æ”¹ `NEXTAUTH_SECRET` ä¸ºå¼ºéšæœºå­—ç¬¦ä¸²
- [ ] ä¿®æ”¹ MySQL å¯†ç ä¸ºå¼ºå¯†ç 
- [ ] è®¾ç½® `NEXTAUTH_URL` ä¸ºå®é™…åŸŸå
- [ ] é…ç½® HTTPS è¯ä¹¦
- [ ] è€ƒè™‘ä½¿ç”¨å¯¹è±¡å­˜å‚¨æ›¿ä»£æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿ
- [ ] é…ç½®å®šæœŸæ•°æ®åº“å¤‡ä»½
- [ ] å¯ç”¨ CDN åŠ é€Ÿé™æ€èµ„æº
- [ ] é…ç½®è¿›ç¨‹å®ˆæŠ¤ï¼ˆPM2/Systemdï¼‰
- [ ] è®¾ç½®é˜²ç«å¢™è§„åˆ™
- [ ] é…ç½®æ—¥å¿—æ”¶é›†å’Œç›‘æ§

### æ€§èƒ½ä¼˜åŒ–å»ºè®®

1. **å›¾ç‰‡ä¼˜åŒ–**ï¼šä½¿ç”¨ Next.js Image ç»„ä»¶è‡ªåŠ¨ä¼˜åŒ–
2. **æ•°æ®åº“ç´¢å¼•**ï¼šä¸ºå¸¸ç”¨æŸ¥è¯¢å­—æ®µæ·»åŠ ç´¢å¼•
3. **ç¼“å­˜ç­–ç•¥**ï¼šä½¿ç”¨ Redis ç¼“å­˜çƒ­ç‚¹æ•°æ®
4. **CDN åŠ é€Ÿ**ï¼šé™æ€èµ„æºå’Œä¸Šä¼ å›¾ç‰‡ä½¿ç”¨ CDN
5. **æ‡’åŠ è½½**ï¼šå›¾ç‰‡ç½‘æ ¼ä½¿ç”¨è™šæ‹Ÿæ»šåŠ¨

## å¼€å‘æŒ‡å—

### æ·»åŠ æ–°çš„ API è·¯ç”±

```typescript
// app/api/your-route/route.ts
import { NextResponse } from "next/server";
import { requireAuth } from "@/lib/auth-guards";
import { prisma } from "@/lib/db";

export async function GET(request: Request) {
  const authCheck = await requireAuth();
  if ("error" in authCheck) return authCheck.error;

  // ä½ çš„ä¸šåŠ¡é€»è¾‘
  const data = await prisma.yourModel.findMany();

  return NextResponse.json(data);
}
```

### æ·»åŠ æ–°çš„é¡µé¢

```typescript
// app/your-page/page.tsx
export default function YourPage() {
  return (
    <div>
      <h1>Your Page</h1>
    </div>
  );
}
```

### ä¿®æ”¹æ•°æ®åº“ Schema

1. ç¼–è¾‘ `prisma/schema.prisma`
2. è¿è¡Œ `pnpm prisma:generate`
3. è¿è¡Œ `pnpm prisma:push`ï¼ˆå¼€å‘ç¯å¢ƒï¼‰æˆ– `npx prisma migrate dev`ï¼ˆç”Ÿäº§ç¯å¢ƒï¼‰

## è´¡çŒ®æŒ‡å—

æ¬¢è¿æäº¤ Issue å’Œ Pull Requestï¼

1. Fork æœ¬ä»“åº“
2. åˆ›å»ºç‰¹æ€§åˆ†æ”¯ï¼ˆ`git checkout -b feature/AmazingFeature`ï¼‰
3. æäº¤æ›´æ”¹ï¼ˆ`git commit -m 'Add some AmazingFeature'`ï¼‰
4. æ¨é€åˆ°åˆ†æ”¯ï¼ˆ`git push origin feature/AmazingFeature`ï¼‰
5. å¼€å¯ Pull Request

## è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ MIT è®¸å¯è¯ - è¯¦è§ [LICENSE](LICENSE) æ–‡ä»¶

## è‡´è°¢

- [Next.js](https://nextjs.org/) - React æ¡†æ¶
- [Prisma](https://www.prisma.io/) - æ•°æ®åº“ ORM
- [NextAuth.js](https://next-auth.js.org/) - è®¤è¯è§£å†³æ–¹æ¡ˆ
- [Tailwind CSS](https://tailwindcss.com/) - CSS æ¡†æ¶
- [shadcn/ui](https://ui.shadcn.com/) - UI ç»„ä»¶åº“
- [sharp](https://sharp.pixelplumbing.com/) - å›¾ç‰‡å¤„ç†åº“
